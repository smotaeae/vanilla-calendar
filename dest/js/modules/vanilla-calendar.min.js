"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var VanillaCalendar=function(){function a(t){var e;_classCallCheck(this,a),this.HTMLElement=t.HTMLElement,this.type=null!=(e=t.type)?e:"default",this.date={min:null!=(e=null==(e=t.date)?void 0:e.min)?e:"1970-01-01",max:null!=(e=null==(e=t.date)?void 0:e.max)?e:"2470-12-31",today:null!=(e=null==(e=t.date)?void 0:e.today)?e:new Date},this.settings={lang:null!=(e=null==(e=t.settings)?void 0:e.lang)?e:"en",iso8601:null==(e=null==(e=t.settings)?void 0:e.iso8601)||e,range:{min:null!=(e=null==(e=t.settings)||null==(e=e.range)?void 0:e.min)?e:this.date.min,max:null!=(e=null==(e=t.settings)||null==(e=e.range)?void 0:e.max)?e:this.date.max,disabled:null!=(e=null==(e=t.settings)||null==(e=e.range)?void 0:e.disabled)?e:null},selection:{day:null!=(e=null==(e=t.settings)||null==(e=e.selection)?void 0:e.day)?e:"single",month:null==(e=null==(e=t.settings)||null==(e=e.selection)?void 0:e.month)||e,year:null==(e=null==(e=t.settings)||null==(e=e.selection)?void 0:e.year)||e},selected:{dates:null!=(e=null==(e=t.settings)||null==(e=e.selected)?void 0:e.dates)?e:null,month:null!=(e=null==(e=t.settings)||null==(e=e.selected)?void 0:e.month)?e:null,year:null!=(e=null==(e=t.settings)||null==(e=e.selected)?void 0:e.year)?e:null,holidays:null!=(e=null==(e=t.settings)||null==(e=e.selected)?void 0:e.holidays)?e:null},visibility:{weekend:null==(e=null==(e=t.settings)||null==(e=e.visibility)?void 0:e.weekend)||e,today:null==(e=null==(e=t.settings)||null==(e=e.visibility)?void 0:e.today)||e,disabled:null!=(e=null==(e=t.settings)||null==(e=e.visibility)?void 0:e.disabled)&&e}},this.actions={clickDay:null!=(e=null==(e=t.actions)?void 0:e.clickDay)?e:null,clickMonth:null!=(e=null==(e=t.actions)?void 0:e.clickMonth)?e:null,clickYear:null!=(t=null==(e=t.actions)?void 0:e.clickYear)?t:null},this.name={months:{full:{en:["January","February","March","April","May","June","July","August","September","October","November","December"],ru:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"]},reduction:{en:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ru:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"]}},week:{en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ru:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},arrow:{prev:{en:"Prev",ru:"Назад"},next:{en:"Next",ru:"Вперед"}}},this.currentType=this.type}return _createClass(a,[{key:"setVariablesDates",value:function(){this.selectedDates=[],this.selectedMonth=this.date.today.getMonth(),this.selectedYear=this.date.today.getFullYear(),null!==this.settings.selected.dates&&(this.selectedDates=this.settings.selected.dates),null!==this.settings.selected.month&&0<=this.settings.selected.month&&this.settings.selected.month<12&&(this.selectedMonth=this.settings.selected.month),null!==this.settings.selected.year&&0<=this.settings.selected.year&&this.settings.selected.year<=9999&&(this.selectedYear=this.settings.selected.year),this.viewYear=this.selectedYear,this.dateMin=this.settings.visibility.disabled?new Date(this.date.min):new Date(this.settings.range.min),this.dateMax=this.settings.visibility.disabled?new Date(this.date.max):new Date(this.settings.range.max)}},{key:"createDOM",value:function(){var t;"default"===this.currentType?(this.HTMLElement.classList.add("vanilla-calendar_default"),this.HTMLElement.classList.remove("vanilla-calendar_month"),this.HTMLElement.classList.remove("vanilla-calendar_year"),this.HTMLElement.innerHTML='\n\t\t\t<div class="vanilla-calendar-header">\n\t\t\t\t<button type="button"\n\t\t\t\t\tclass="vanilla-calendar-arrow vanilla-calendar-arrow_prev">\n\t\t\t\t\t'.concat(null!=(t=this.name.arrow.prev[this.settings.lang])?t:this.name.arrow.prev.en,'\n\t\t\t\t</button>\n\t\t\t\t<div class="vanilla-calendar-header__content">\n\t\t\t\t\t<b class="vanilla-calendar-month').concat(this.settings.selection.month?"":" vanilla-calendar-month_disabled",'"></b>\n\t\t\t\t\t<b class="vanilla-calendar-year').concat(this.settings.selection.year?"":" vanilla-calendar-year_disabled",'"></b>\n\t\t\t\t</div>\n\t\t\t\t<button type="button"\n\t\t\t\t\tclass="vanilla-calendar-arrow vanilla-calendar-arrow_next">\n\t\t\t\t\t').concat(null!=(t=this.name.arrow.next[this.settings.lang])?t:this.name.arrow.next.en,'\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="vanilla-calendar-content">\n\t\t\t\t<div class="vanilla-calendar-week"></div>\n\t\t\t\t<div class="vanilla-calendar-days"></div>\n\t\t\t</div>\n\t\t')):"month"===this.currentType?(this.HTMLElement.classList.remove("vanilla-calendar_default"),this.HTMLElement.classList.add("vanilla-calendar_month"),this.HTMLElement.classList.remove("vanilla-calendar_year"),this.HTMLElement.innerHTML='\n\t\t\t<div class="vanilla-calendar-header">\n\t\t\t\t<button type="button"\n\t\t\t\t\tclass="vanilla-calendar-arrow vanilla-calendar-arrow_prev"\n\t\t\t\t\tstyle="visibility: hidden">\n\t\t\t\t\t'.concat(null!=(t=this.name.arrow.prev[this.settings.lang])?t:this.name.arrow.prev.en,'\n\t\t\t\t</button>\n\t\t\t\t<div class="vanilla-calendar-header__content">\n\t\t\t\t\t<b class="vanilla-calendar-month"></b>\n\t\t\t\t\t<b class="vanilla-calendar-year vanilla-calendar-year_not-active').concat(this.settings.selection.year?"":" vanilla-calendar-year_disabled",'"></b>\n\t\t\t\t</div>\n\t\t\t\t<button type="button"\n\t\t\t\t\tclass="vanilla-calendar-arrow vanilla-calendar-arrow_next"\n\t\t\t\t\tstyle="visibility: hidden">\n\t\t\t\t\t').concat(null!=(t=this.name.arrow.next[this.settings.lang])?t:this.name.arrow.next.en,'\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="vanilla-calendar-content">\n\t\t\t\t<div class="vanilla-calendar-months"></div>\n\t\t\t</div>')):"year"===this.currentType&&(this.HTMLElement.classList.remove("vanilla-calendar_default"),this.HTMLElement.classList.remove("vanilla-calendar_month"),this.HTMLElement.classList.add("vanilla-calendar_year"),this.HTMLElement.innerHTML='\n\t\t\t<div class="vanilla-calendar-header">\n\t\t\t\t<button type="button"\n\t\t\t\t\tclass="vanilla-calendar-arrow vanilla-calendar-arrow_prev">\n\t\t\t\t\t'.concat(null!=(t=this.name.arrow.prev[this.settings.lang])?t:this.name.arrow.prev.en,'\n\t\t\t\t</button>\n\t\t\t\t<div class="vanilla-calendar-header__content">\n\t\t\t\t\t<b class="vanilla-calendar-month vanilla-calendar-month_not-active').concat(this.settings.selection.month?"":" vanilla-calendar-month_disabled",'"></b>\n\t\t\t\t\t<b class="vanilla-calendar-year"></b>\n\t\t\t\t</div>\n\t\t\t\t<button type="button"\n\t\t\t\t\tclass="vanilla-calendar-arrow vanilla-calendar-arrow_next">\n\t\t\t\t\t').concat(null!=(t=this.name.arrow.next[this.settings.lang])?t:this.name.arrow.next.en,'\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="vanilla-calendar-content">\n\t\t\t\t<div class="vanilla-calendar-years"></div>\n\t\t\t</div>'))}},{key:"controlArrows",value:function(){var t,e,a,n,l,s,i=this;["default","year"].includes(this.currentType)&&(t=this.HTMLElement.querySelector(".vanilla-calendar-arrow_prev"),e=this.HTMLElement.querySelector(".vanilla-calendar-arrow_next"),"default"===i.currentType&&(a=i.selectedMonth===i.dateMin.getMonth(),n=i.selectedMonth===i.dateMax.getMonth(),l=i.selectedYear===i.dateMin.getFullYear(),s=i.selectedYear===i.dateMax.getFullYear(),a&&l||!i.settings.selection.month?t.style.visibility="hidden":t.style.visibility=null,n&&s||!i.settings.selection.month?e.style.visibility="hidden":e.style.visibility=null),"year"===i.currentType&&(i.dateMin.getFullYear()&&i.viewYear-7<=i.dateMin.getFullYear()?t.style.visibility="hidden":t.style.visibility=null,i.dateMax.getFullYear()&&i.viewYear+7>=i.dateMax.getFullYear()?e.style.visibility="hidden":e.style.visibility=null))}},{key:"writeYear",value:function(){this.HTMLElement.querySelector(".vanilla-calendar-year").innerText=this.selectedYear}},{key:"writeMonth",value:function(){this.HTMLElement.querySelector(".vanilla-calendar-month").innerText=this.name.months.full[this.settings.lang][this.selectedMonth]}},{key:"createWeek",value:function(){var t=this.HTMLElement.querySelector(".vanilla-calendar-week"),e=this.name.week[this.settings.lang];e.push(e.shift());for(var a=0;a<e.length;a++){var n=e[a],l=document.createElement("span");l.className="vanilla-calendar-week__day",this.settings.visibility.weekend&&this.settings.iso8601?5!==a&&6!==a||l.classList.add("vanilla-calendar-week__day_weekend"):!this.settings.visibility.weekend||this.settings.iso8601||0!==a&&6!==a||l.classList.add("vanilla-calendar-week__day_weekend"),l.innerText="".concat(n),t.append(l)}}},{key:"createDays",value:function(){var s=this,t=new Date(this.selectedYear,this.selectedMonth,1),e=new Date(this.selectedYear,this.selectedMonth+1,0).getDate(),a=Number(t.getDay()),i=(this.settings.iso8601&&(a=Number((0!==t.getDay()?t.getDay():7)-1)),this.HTMLElement.querySelector(".vanilla-calendar-days")),n=(["single","multiple"].includes(this.settings.selection.day)&&i.classList.add("vanilla-calendar-days_selecting"),i.innerHTML="",new Date(s.selectedYear,s.selectedMonth,0).getDate()-a),l=s.selectedYear,r=s.selectedMonth;0===s.selectedMonth?(r=s.name.months.full[s.settings.lang].length,l=s.selectedYear-1):s.selectedMonth<10&&(r="0".concat(s.selectedMonth));for(var c=0;c<a;c++){var d=document.createElement("span");n+=1,d.className="vanilla-calendar-day vanilla-calendar-day_prev",d.innerText="".concat(n),d.dataset.calendarDay="".concat(l,"-").concat(r,"-").concat(n),i.append(d)}for(var o=s.selectedYear,h=s.selectedMonth<10?"0".concat(s.selectedMonth+1):s.selectedMonth+1,u=1;u<=e;u++)!function(t){var e=document.createElement("span"),a=t<10?"0".concat(t):t,n="".concat(o,"-").concat(h,"-").concat(a),a=new Date(n).getDay(),a=(e.className="vanilla-calendar-day",e.innerText="".concat(t),e.dataset.calendarDay=n,!s.settings.visibility.weekend||0!==a&&6!==a||e.classList.add("vanilla-calendar-day_weekend"),Array.isArray(s.settings.selected.holidays)&&s.settings.selected.holidays.forEach(function(t){t===n&&e.classList.add("vanilla-calendar-day_holiday")}),t===s.date.today.getDate()),t=s.selectedMonth===s.date.today.getMonth(),l=s.selectedYear===s.date.today.getFullYear();s.settings.visibility.today&&a&&t&&l&&e.classList.add("vanilla-calendar-day_today"),s.selectedDates.find(function(t){return t===n})&&e.classList.add("vanilla-calendar-day_selected"),(s.settings.range.min>n||s.settings.range.max<n)&&e.classList.add("vanilla-calendar-day_disabled"),Array.isArray(s.settings.range.disabled)&&s.settings.range.disabled.forEach(function(t){t===n&&e.classList.add("vanilla-calendar-day_disabled")}),i.append(e)}(u);var t=a+e,v=Math.ceil(t/s.name.week[s.settings.lang].length),y=s.name.week[s.settings.lang].length*v-t,g=s.selectedYear,m=s.selectedMonth+2;s.selectedMonth+1===s.name.months.full[s.settings.lang].length?(m="01",g=s.selectedYear+1):s.selectedMonth+2<10&&(m="0".concat(s.selectedMonth+2));for(var M=1;M<=y;M++){var p=document.createElement("span"),_=M<10?"0".concat(M):M;p.className="vanilla-calendar-day vanilla-calendar-day_next",p.innerText="".concat(M),p.dataset.calendarDay="".concat(g,"-").concat(m,"-").concat(_),i.append(p)}}},{key:"changeMonth",value:function(t){var e=this.name.months.full[this.settings.lang].length-1;t.closest(".vanilla-calendar-arrow_prev")?0!==this.selectedMonth?--this.selectedMonth:(--this.selectedYear,this.selectedMonth=e):t.closest(".vanilla-calendar-arrow_next")&&(this.selectedMonth!==e?this.selectedMonth+=1:(this.selectedYear+=1,this.selectedMonth=0)),this.settings.selected.month=this.selectedMonth,this.controlArrows(),this.writeYear(),this.writeMonth(),this.createDays()}},{key:"createYears",value:function(){this.currentType="year",this.createDOM(),this.controlArrows(),this.writeYear(),this.writeMonth();var t=this.HTMLElement.querySelector(".vanilla-calendar-years");this.settings.selection.year&&t.classList.add("vanilla-calendar-years_selecting");for(var e=this.viewYear-7;e<this.viewYear+8;e++){var a=e,n=document.createElement("span");n.className="vanilla-calendar-years__year",a===this.selectedYear&&n.classList.add("vanilla-calendar-years__year_selected"),a<this.dateMin.getFullYear()&&n.classList.add("vanilla-calendar-years__year_disabled"),a>this.dateMax.getFullYear()&&n.classList.add("vanilla-calendar-years__year_disabled"),n.dataset.calendarYear=a,n.innerText="".concat(a),t.append(n)}}},{key:"createMonths",value:function(){this.currentType="month",this.createDOM(),this.writeYear(),this.writeMonth();for(var t=this.HTMLElement.querySelector(".vanilla-calendar-months"),e=(this.settings.selection.month&&t.classList.add("vanilla-calendar-months_selecting"),this.name.months.reduction[this.settings.lang]),a=0;a<e.length;a++){var n=e[a],l=document.createElement("span");l.className="vanilla-calendar-months__month",a===this.selectedMonth&&l.classList.add("vanilla-calendar-months__month_selected"),a<this.dateMin.getMonth()&&this.selectedYear===this.dateMin.getFullYear()&&l.classList.add("vanilla-calendar-months__month_disabled"),a>this.dateMax.getMonth()&&this.selectedYear===this.dateMax.getFullYear()&&l.classList.add("vanilla-calendar-months__month_disabled"),l.dataset.calendarMonth=a,l.innerText="".concat(n),t.append(l)}}},{key:"update",value:function(){this.setVariablesDates(),this.createDOM(),this.controlArrows(),this.writeYear(),this.writeMonth(),"default"===this.currentType?(this.createWeek(),this.createDays()):"month"===this.currentType?this.createMonths():"year"===this.currentType&&this.createYears()}},{key:"click",value:function(){var h=this;this.HTMLElement.addEventListener("click",function(t){var e=t.target.closest(".vanilla-calendar-arrow"),a=t.target.closest(".vanilla-calendar-arrow_prev"),n=t.target.closest(".vanilla-calendar-arrow_next"),l=t.target.closest(".vanilla-calendar-day"),s=t.target.closest(".vanilla-calendar-day_prev"),i=t.target.closest(".vanilla-calendar-day_next"),r=t.target.closest(".vanilla-calendar-year"),c=t.target.closest(".vanilla-calendar-years__year"),d=t.target.closest(".vanilla-calendar-month"),o=t.target.closest(".vanilla-calendar-months__month");["single","multiple"].includes(h.settings.selection.day)&&l?s||i||(h.actions.clickDay&&h.actions.clickDay(t),l.classList.contains("vanilla-calendar-day_selected")?h.selectedDates.splice(h.selectedDates.indexOf(l.dataset.calendarDay),1):("single"===h.settings.selection.day&&(h.selectedDates=[]),h.selectedDates.push(l.dataset.calendarDay)),h.createDays()):e&&"year"!==h.currentType&&"month"!==h.currentType&&h.changeMonth(t.target),h.settings.selection.year&&(e&&"year"===h.currentType?(n?h.viewYear+=15:a&&(h.viewYear-=15),h.createYears()):"year"!==h.currentType&&r?h.createYears():"year"===h.currentType&&r?(h.currentType=h.type,h.update()):c&&(h.actions.clickYear&&h.actions.clickYear(t),s=Number(c.dataset.calendarYear),h.currentType=h.type,h.selectedMonth<h.dateMin.getMonth()&&s===h.dateMin.getFullYear()&&(h.settings.selected.month=h.dateMin.getMonth()),h.selectedMonth>h.dateMax.getMonth()&&s===h.dateMax.getFullYear()&&(h.settings.selected.month=h.dateMax.getMonth()),h.settings.selected.year=s,h.update())),h.settings.selection.month&&("month"!==h.currentType&&d?h.createMonths():"month"===h.currentType&&d?(h.currentType=h.type,h.update()):o&&(h.actions.clickMonth&&h.actions.clickMonth(t),i=Number(o.dataset.calendarMonth),h.currentType=h.type,h.settings.selected.month=i,h.update()))})}},{key:"init",value:function(){this.update(),this.click()}}]),a}();exports.default=VanillaCalendar;